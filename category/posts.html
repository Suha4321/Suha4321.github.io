<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Suha's Blog - Posts</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Suha's Blog Atom Feed" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Suha's Blog </a></h1>
                <nav><ul>
                    <li class="active"><a href="/category/posts.html">Posts</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/baseball-database_design.html">How to design a baseball database</a></h1>
<footer class="post-info">
        <abbr class="published" title="2019-06-03T20:00:00-04:00">
                Published: Mon 03 June 2019
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/suhasini-radhakrishnan.html">Suhasini Radhakrishnan</a>
        </address>
<p>In <a href="/category/posts.html">Posts</a>.</p>
<p>tags: <a href="/tag/python-sqlite3-dbdesigner.html">python Sqlite3 DbDesigner</a> </p>
</footer><!-- /.post-info --><style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Baseball-database-design">Baseball database design<a class="anchor-link" href="#Baseball-database-design">&#182;</a></h1><p>In this project we will be working with the base ball Major League Data found in Retrosheet.
<a href="https://www.retrosheet.org/">https://www.retrosheet.org/</a></p>
<p>The main file that we will be working with combines 127 separate csv files from retrosheet and is in game_log.csv.We will normalise the datapoints in this table to create a database structure.</p>
<p>In addition to the main files, the helper files also sourced from Retrosheet:</p>
<ul>
<li>park_codes.csv</li>
<li>person_codes.csv</li>
<li>team_codes.csv</li>
</ul>
<p>The data dictionary for the events can be found here - <a href="http://www.retrosheet.org/eventfile.htm">http://www.retrosheet.org/eventfile.htm</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.style</span> <span class="k">as</span> <span class="nn">style</span>
<span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># setting to avoid data trucation</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;max_columns&#39;</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;max_rows&#39;</span><span class="p">,</span> <span class="mi">200000</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;max_colwidth&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#reading data dictionary</span>
<span class="n">game_log</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;game_log.csv&#39;</span><span class="p">,</span> <span class="n">low_memory</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">park_codes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;park_codes.csv&#39;</span><span class="p">)</span>
<span class="n">person_code</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;person_codes.csv&#39;</span><span class="p">)</span>
<span class="n">team</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;team_codes.csv&#39;</span><span class="p">)</span>
<span class="n">game_log</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[2]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>number_of_game</th>
      <th>day_of_week</th>
      <th>v_name</th>
      <th>v_league</th>
      <th>v_game_number</th>
      <th>h_name</th>
      <th>h_league</th>
      <th>h_game_number</th>
      <th>v_score</th>
      <th>h_score</th>
      <th>length_outs</th>
      <th>day_night</th>
      <th>completion</th>
      <th>forefeit</th>
      <th>protest</th>
      <th>park_id</th>
      <th>attendance</th>
      <th>length_minutes</th>
      <th>v_line_score</th>
      <th>h_line_score</th>
      <th>v_at_bats</th>
      <th>v_hits</th>
      <th>v_doubles</th>
      <th>v_triples</th>
      <th>v_homeruns</th>
      <th>v_rbi</th>
      <th>v_sacrifice_hits</th>
      <th>v_sacrifice_flies</th>
      <th>v_hit_by_pitch</th>
      <th>v_walks</th>
      <th>v_intentional_walks</th>
      <th>v_strikeouts</th>
      <th>v_stolen_bases</th>
      <th>v_caught_stealing</th>
      <th>v_grounded_into_double</th>
      <th>v_first_catcher_interference</th>
      <th>v_left_on_base</th>
      <th>v_pitchers_used</th>
      <th>v_individual_earned_runs</th>
      <th>v_team_earned_runs</th>
      <th>v_wild_pitches</th>
      <th>v_balks</th>
      <th>v_putouts</th>
      <th>v_assists</th>
      <th>v_errors</th>
      <th>v_passed_balls</th>
      <th>v_double_plays</th>
      <th>v_triple_plays</th>
      <th>h_at_bats</th>
      <th>h_hits</th>
      <th>h_doubles</th>
      <th>h_triples</th>
      <th>h_homeruns</th>
      <th>h_rbi</th>
      <th>h_sacrifice_hits</th>
      <th>h_sacrifice_flies</th>
      <th>h_hit_by_pitch</th>
      <th>h_walks</th>
      <th>h_intentional_walks</th>
      <th>h_strikeouts</th>
      <th>h_stolen_bases</th>
      <th>h_caught_stealing</th>
      <th>h_grounded_into_double</th>
      <th>h_first_catcher_interference</th>
      <th>h_left_on_base</th>
      <th>h_pitchers_used</th>
      <th>h_individual_earned_runs</th>
      <th>h_team_earned_runs</th>
      <th>h_wild_pitches</th>
      <th>h_balks</th>
      <th>h_putouts</th>
      <th>h_assists</th>
      <th>h_errors</th>
      <th>h_passed_balls</th>
      <th>h_double_plays</th>
      <th>h_triple_plays</th>
      <th>hp_umpire_id</th>
      <th>hp_umpire_name</th>
      <th>1b_umpire_id</th>
      <th>1b_umpire_name</th>
      <th>2b_umpire_id</th>
      <th>2b_umpire_name</th>
      <th>3b_umpire_id</th>
      <th>3b_umpire_name</th>
      <th>lf_umpire_id</th>
      <th>lf_umpire_name</th>
      <th>rf_umpire_id</th>
      <th>rf_umpire_name</th>
      <th>v_manager_id</th>
      <th>v_manager_name</th>
      <th>h_manager_id</th>
      <th>h_manager_name</th>
      <th>winning_pitcher_id</th>
      <th>winning_pitcher_name</th>
      <th>losing_pitcher_id</th>
      <th>losing_pitcher_name</th>
      <th>saving_pitcher_id</th>
      <th>saving_pitcher_name</th>
      <th>winning_rbi_batter_id</th>
      <th>winning_rbi_batter_id_name</th>
      <th>v_starting_pitcher_id</th>
      <th>v_starting_pitcher_name</th>
      <th>h_starting_pitcher_id</th>
      <th>h_starting_pitcher_name</th>
      <th>v_player_1_id</th>
      <th>v_player_1_name</th>
      <th>v_player_1_def_pos</th>
      <th>v_player_2_id</th>
      <th>v_player_2_name</th>
      <th>v_player_2_def_pos</th>
      <th>v_player_3_id</th>
      <th>v_player_3_name</th>
      <th>v_player_3_def_pos</th>
      <th>v_player_4_id</th>
      <th>v_player_4_name</th>
      <th>v_player_4_def_pos</th>
      <th>v_player_5_id</th>
      <th>v_player_5_name</th>
      <th>v_player_5_def_pos</th>
      <th>v_player_6_id</th>
      <th>v_player_6_name</th>
      <th>v_player_6_def_pos</th>
      <th>v_player_7_id</th>
      <th>v_player_7_name</th>
      <th>v_player_7_def_pos</th>
      <th>v_player_8_id</th>
      <th>v_player_8_name</th>
      <th>v_player_8_def_pos</th>
      <th>v_player_9_id</th>
      <th>v_player_9_name</th>
      <th>v_player_9_def_pos</th>
      <th>h_player_1_id</th>
      <th>h_player_1_name</th>
      <th>h_player_1_def_pos</th>
      <th>h_player_2_id</th>
      <th>h_player_2_name</th>
      <th>h_player_2_def_pos</th>
      <th>h_player_3_id</th>
      <th>h_player_3_name</th>
      <th>h_player_3_def_pos</th>
      <th>h_player_4_id</th>
      <th>h_player_4_name</th>
      <th>h_player_4_def_pos</th>
      <th>h_player_5_id</th>
      <th>h_player_5_name</th>
      <th>h_player_5_def_pos</th>
      <th>h_player_6_id</th>
      <th>h_player_6_name</th>
      <th>h_player_6_def_pos</th>
      <th>h_player_7_id</th>
      <th>h_player_7_name</th>
      <th>h_player_7_def_pos</th>
      <th>h_player_8_id</th>
      <th>h_player_8_name</th>
      <th>h_player_8_def_pos</th>
      <th>h_player_9_id</th>
      <th>h_player_9_name</th>
      <th>h_player_9_def_pos</th>
      <th>additional_info</th>
      <th>acquisition_info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18710504</td>
      <td>0</td>
      <td>Thu</td>
      <td>CL1</td>
      <td>NaN</td>
      <td>1</td>
      <td>FW1</td>
      <td>NaN</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>54.0</td>
      <td>D</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>FOR01</td>
      <td>200.0</td>
      <td>120.0</td>
      <td>000000000</td>
      <td>010010000</td>
      <td>30.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>-1.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>27.0</td>
      <td>9.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>31.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>-1.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>27.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>boakj901</td>
      <td>John Boake</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>paboc101</td>
      <td>Charlie Pabor</td>
      <td>lennb101</td>
      <td>Bill Lennon</td>
      <td>mathb101</td>
      <td>Bobby Mathews</td>
      <td>prata101</td>
      <td>Al Pratt</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>prata101</td>
      <td>Al Pratt</td>
      <td>mathb101</td>
      <td>Bobby Mathews</td>
      <td>whitd102</td>
      <td>Deacon White</td>
      <td>2.0</td>
      <td>kimbg101</td>
      <td>Gene Kimball</td>
      <td>4.0</td>
      <td>paboc101</td>
      <td>Charlie Pabor</td>
      <td>7.0</td>
      <td>allia101</td>
      <td>Art Allison</td>
      <td>8.0</td>
      <td>white104</td>
      <td>Elmer White</td>
      <td>9.0</td>
      <td>prata101</td>
      <td>Al Pratt</td>
      <td>1.0</td>
      <td>sutte101</td>
      <td>Ezra Sutton</td>
      <td>5.0</td>
      <td>carlj102</td>
      <td>Jim Carleton</td>
      <td>3.0</td>
      <td>bassj101</td>
      <td>John Bass</td>
      <td>6.0</td>
      <td>selmf101</td>
      <td>Frank Sellman</td>
      <td>5.0</td>
      <td>mathb101</td>
      <td>Bobby Mathews</td>
      <td>1.0</td>
      <td>foraj101</td>
      <td>Jim Foran</td>
      <td>3.0</td>
      <td>goldw101</td>
      <td>Wally Goldsmith</td>
      <td>6.0</td>
      <td>lennb101</td>
      <td>Bill Lennon</td>
      <td>2.0</td>
      <td>caret101</td>
      <td>Tom Carey</td>
      <td>4.0</td>
      <td>mince101</td>
      <td>Ed Mincher</td>
      <td>7.0</td>
      <td>mcdej101</td>
      <td>James McDermott</td>
      <td>8.0</td>
      <td>kellb105</td>
      <td>Bill Kelly</td>
      <td>9.0</td>
      <td>NaN</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18710505</td>
      <td>0</td>
      <td>Fri</td>
      <td>BS1</td>
      <td>NaN</td>
      <td>1</td>
      <td>WS3</td>
      <td>NaN</td>
      <td>1</td>
      <td>20</td>
      <td>18</td>
      <td>54.0</td>
      <td>D</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>WAS01</td>
      <td>5000.0</td>
      <td>145.0</td>
      <td>107000435</td>
      <td>640113030</td>
      <td>41.0</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>13.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>18.0</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>-1.0</td>
      <td>NaN</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>27.0</td>
      <td>13.0</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>49.0</td>
      <td>14.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>-1.0</td>
      <td>NaN</td>
      <td>14.0</td>
      <td>1.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>27.0</td>
      <td>20.0</td>
      <td>10.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>dobsh901</td>
      <td>Henry Dobson</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>wrigh101</td>
      <td>Harry Wright</td>
      <td>younn801</td>
      <td>Nick Young</td>
      <td>spala101</td>
      <td>Al Spalding</td>
      <td>braia102</td>
      <td>Asa Brainard</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>spala101</td>
      <td>Al Spalding</td>
      <td>braia102</td>
      <td>Asa Brainard</td>
      <td>wrigg101</td>
      <td>George Wright</td>
      <td>6.0</td>
      <td>barnr102</td>
      <td>Ross Barnes</td>
      <td>4.0</td>
      <td>birdd102</td>
      <td>Dave Birdsall</td>
      <td>9.0</td>
      <td>mcvec101</td>
      <td>Cal McVey</td>
      <td>2.0</td>
      <td>wrigh101</td>
      <td>Harry Wright</td>
      <td>8.0</td>
      <td>goulc101</td>
      <td>Charlie Gould</td>
      <td>3.0</td>
      <td>schah101</td>
      <td>Harry Schafer</td>
      <td>5.0</td>
      <td>conef101</td>
      <td>Fred Cone</td>
      <td>7.0</td>
      <td>spala101</td>
      <td>Al Spalding</td>
      <td>1.0</td>
      <td>watef102</td>
      <td>Fred Waterman</td>
      <td>5.0</td>
      <td>forcd101</td>
      <td>Davy Force</td>
      <td>6.0</td>
      <td>mille105</td>
      <td>Everett Mills</td>
      <td>3.0</td>
      <td>allid101</td>
      <td>Doug Allison</td>
      <td>2.0</td>
      <td>hallg101</td>
      <td>George Hall</td>
      <td>7.0</td>
      <td>leona101</td>
      <td>Andy Leonard</td>
      <td>4.0</td>
      <td>braia102</td>
      <td>Asa Brainard</td>
      <td>1.0</td>
      <td>burrh101</td>
      <td>Henry Burroughs</td>
      <td>9.0</td>
      <td>berth101</td>
      <td>Henry Berthrong</td>
      <td>8.0</td>
      <td>HTBF</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18710506</td>
      <td>0</td>
      <td>Sat</td>
      <td>CL1</td>
      <td>NaN</td>
      <td>2</td>
      <td>RC1</td>
      <td>NaN</td>
      <td>1</td>
      <td>12</td>
      <td>4</td>
      <td>54.0</td>
      <td>D</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>RCK01</td>
      <td>1000.0</td>
      <td>140.0</td>
      <td>610020003</td>
      <td>010020100</td>
      <td>49.0</td>
      <td>11.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>-1.0</td>
      <td>NaN</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>27.0</td>
      <td>12.0</td>
      <td>8.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>36.0</td>
      <td>7.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>-1.0</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>27.0</td>
      <td>12.0</td>
      <td>13.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>mawnj901</td>
      <td>J.H. Manny</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>paboc101</td>
      <td>Charlie Pabor</td>
      <td>hasts101</td>
      <td>Scott Hastings</td>
      <td>prata101</td>
      <td>Al Pratt</td>
      <td>fishc102</td>
      <td>Cherokee Fisher</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>prata101</td>
      <td>Al Pratt</td>
      <td>fishc102</td>
      <td>Cherokee Fisher</td>
      <td>whitd102</td>
      <td>Deacon White</td>
      <td>2.0</td>
      <td>kimbg101</td>
      <td>Gene Kimball</td>
      <td>4.0</td>
      <td>paboc101</td>
      <td>Charlie Pabor</td>
      <td>7.0</td>
      <td>allia101</td>
      <td>Art Allison</td>
      <td>8.0</td>
      <td>white104</td>
      <td>Elmer White</td>
      <td>9.0</td>
      <td>prata101</td>
      <td>Al Pratt</td>
      <td>1.0</td>
      <td>sutte101</td>
      <td>Ezra Sutton</td>
      <td>5.0</td>
      <td>carlj102</td>
      <td>Jim Carleton</td>
      <td>3.0</td>
      <td>bassj101</td>
      <td>John Bass</td>
      <td>6.0</td>
      <td>mackd101</td>
      <td>Denny Mack</td>
      <td>3.0</td>
      <td>addyb101</td>
      <td>Bob Addy</td>
      <td>4.0</td>
      <td>fishc102</td>
      <td>Cherokee Fisher</td>
      <td>1.0</td>
      <td>hasts101</td>
      <td>Scott Hastings</td>
      <td>8.0</td>
      <td>ham-r101</td>
      <td>Ralph Ham</td>
      <td>5.0</td>
      <td>ansoc101</td>
      <td>Cap Anson</td>
      <td>2.0</td>
      <td>sagep101</td>
      <td>Pony Sager</td>
      <td>6.0</td>
      <td>birdg101</td>
      <td>George Bird</td>
      <td>7.0</td>
      <td>stirg101</td>
      <td>Gat Stires</td>
      <td>9.0</td>
      <td>NaN</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>3</th>
      <td>18710508</td>
      <td>0</td>
      <td>Mon</td>
      <td>CL1</td>
      <td>NaN</td>
      <td>3</td>
      <td>CH1</td>
      <td>NaN</td>
      <td>1</td>
      <td>12</td>
      <td>14</td>
      <td>54.0</td>
      <td>D</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CHI01</td>
      <td>5000.0</td>
      <td>150.0</td>
      <td>101403111</td>
      <td>077000000</td>
      <td>46.0</td>
      <td>15.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>-1.0</td>
      <td>NaN</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>27.0</td>
      <td>15.0</td>
      <td>11.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>43.0</td>
      <td>11.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>-1.0</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>27.0</td>
      <td>14.0</td>
      <td>7.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>willg901</td>
      <td>Gardner Willard</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>paboc101</td>
      <td>Charlie Pabor</td>
      <td>woodj106</td>
      <td>Jimmy Wood</td>
      <td>zettg101</td>
      <td>George Zettlein</td>
      <td>prata101</td>
      <td>Al Pratt</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>prata101</td>
      <td>Al Pratt</td>
      <td>zettg101</td>
      <td>George Zettlein</td>
      <td>whitd102</td>
      <td>Deacon White</td>
      <td>2.0</td>
      <td>kimbg101</td>
      <td>Gene Kimball</td>
      <td>4.0</td>
      <td>paboc101</td>
      <td>Charlie Pabor</td>
      <td>7.0</td>
      <td>allia101</td>
      <td>Art Allison</td>
      <td>8.0</td>
      <td>white104</td>
      <td>Elmer White</td>
      <td>9.0</td>
      <td>prata101</td>
      <td>Al Pratt</td>
      <td>1.0</td>
      <td>sutte101</td>
      <td>Ezra Sutton</td>
      <td>5.0</td>
      <td>carlj102</td>
      <td>Jim Carleton</td>
      <td>3.0</td>
      <td>bassj101</td>
      <td>John Bass</td>
      <td>6.0</td>
      <td>mcatb101</td>
      <td>Bub McAtee</td>
      <td>3.0</td>
      <td>kingm101</td>
      <td>Marshall King</td>
      <td>8.0</td>
      <td>hodec101</td>
      <td>Charlie Hodes</td>
      <td>2.0</td>
      <td>woodj106</td>
      <td>Jimmy Wood</td>
      <td>4.0</td>
      <td>simmj101</td>
      <td>Joe Simmons</td>
      <td>9.0</td>
      <td>folet101</td>
      <td>Tom Foley</td>
      <td>7.0</td>
      <td>duffe101</td>
      <td>Ed Duffy</td>
      <td>6.0</td>
      <td>pinke101</td>
      <td>Ed Pinkham</td>
      <td>5.0</td>
      <td>zettg101</td>
      <td>George Zettlein</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>4</th>
      <td>18710509</td>
      <td>0</td>
      <td>Tue</td>
      <td>BS1</td>
      <td>NaN</td>
      <td>2</td>
      <td>TRO</td>
      <td>NaN</td>
      <td>1</td>
      <td>9</td>
      <td>5</td>
      <td>54.0</td>
      <td>D</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TRO01</td>
      <td>3250.0</td>
      <td>145.0</td>
      <td>000002232</td>
      <td>101003000</td>
      <td>46.0</td>
      <td>17.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>-1.0</td>
      <td>NaN</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>27.0</td>
      <td>12.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>36.0</td>
      <td>9.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>-1.0</td>
      <td>NaN</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>27.0</td>
      <td>11.0</td>
      <td>7.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>leroi901</td>
      <td>Isaac Leroy</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>wrigh101</td>
      <td>Harry Wright</td>
      <td>pikel101</td>
      <td>Lip Pike</td>
      <td>spala101</td>
      <td>Al Spalding</td>
      <td>mcmuj101</td>
      <td>John McMullin</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>spala101</td>
      <td>Al Spalding</td>
      <td>mcmuj101</td>
      <td>John McMullin</td>
      <td>wrigg101</td>
      <td>George Wright</td>
      <td>6.0</td>
      <td>barnr102</td>
      <td>Ross Barnes</td>
      <td>4.0</td>
      <td>birdd102</td>
      <td>Dave Birdsall</td>
      <td>9.0</td>
      <td>mcvec101</td>
      <td>Cal McVey</td>
      <td>2.0</td>
      <td>wrigh101</td>
      <td>Harry Wright</td>
      <td>8.0</td>
      <td>goulc101</td>
      <td>Charlie Gould</td>
      <td>3.0</td>
      <td>schah101</td>
      <td>Harry Schafer</td>
      <td>5.0</td>
      <td>conef101</td>
      <td>Fred Cone</td>
      <td>7.0</td>
      <td>spala101</td>
      <td>Al Spalding</td>
      <td>1.0</td>
      <td>flync101</td>
      <td>Clipper Flynn</td>
      <td>9.0</td>
      <td>mcgem101</td>
      <td>Mike McGeary</td>
      <td>2.0</td>
      <td>yorkt101</td>
      <td>Tom York</td>
      <td>8.0</td>
      <td>mcmuj101</td>
      <td>John McMullin</td>
      <td>1.0</td>
      <td>kings101</td>
      <td>Steve King</td>
      <td>7.0</td>
      <td>beave101</td>
      <td>Edward Beavens</td>
      <td>4.0</td>
      <td>bells101</td>
      <td>Steve Bellan</td>
      <td>5.0</td>
      <td>pikel101</td>
      <td>Lip Pike</td>
      <td>3.0</td>
      <td>cravb101</td>
      <td>Bill Craver</td>
      <td>6.0</td>
      <td>HTBF</td>
      <td>Y</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">park_codes</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[3]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>park_id</th>
      <th>name</th>
      <th>aka</th>
      <th>city</th>
      <th>state</th>
      <th>start</th>
      <th>end</th>
      <th>league</th>
      <th>notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ALB01</td>
      <td>Riverside Park</td>
      <td>NaN</td>
      <td>Albany</td>
      <td>NY</td>
      <td>09/11/1880</td>
      <td>05/30/1882</td>
      <td>NL</td>
      <td>TRN:9/11/80;6/15&amp;9/10/1881;5/16-5/18&amp;5/30/1882</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ALT01</td>
      <td>Columbia Park</td>
      <td>NaN</td>
      <td>Altoona</td>
      <td>PA</td>
      <td>04/30/1884</td>
      <td>05/31/1884</td>
      <td>UA</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ANA01</td>
      <td>Angel Stadium of Anaheim</td>
      <td>Edison Field; Anaheim Stadium</td>
      <td>Anaheim</td>
      <td>CA</td>
      <td>04/19/1966</td>
      <td>NaN</td>
      <td>AL</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ARL01</td>
      <td>Arlington Stadium</td>
      <td>NaN</td>
      <td>Arlington</td>
      <td>TX</td>
      <td>04/21/1972</td>
      <td>10/03/1993</td>
      <td>AL</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ARL02</td>
      <td>Rangers Ballpark in Arlington</td>
      <td>The Ballpark in Arlington; Ameriquest Fl</td>
      <td>Arlington</td>
      <td>TX</td>
      <td>04/11/1994</td>
      <td>NaN</td>
      <td>AL</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">game_log</span><span class="p">[</span><span class="s1">&#39;park_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[4]:</div>



<div class="output_text output_subarea output_execute_result">
<pre>STL07    7022
BOS07    6667
CHI11    6526
PHI11    5975
CHI10    5360
Name: park_id, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The park_id in the game_log corresponds to the baseball park the match was played in ; the same as the park_id in the park_codes reference data set.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">person_code</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[5]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>last</th>
      <th>first</th>
      <th>player_debut</th>
      <th>mgr_debut</th>
      <th>coach_debut</th>
      <th>ump_debut</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>aardd001</td>
      <td>Aardsma</td>
      <td>David</td>
      <td>04/06/2004</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>aaroh101</td>
      <td>Aaron</td>
      <td>Hank</td>
      <td>04/13/1954</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>aarot101</td>
      <td>Aaron</td>
      <td>Tommie</td>
      <td>04/10/1962</td>
      <td>NaN</td>
      <td>04/06/1979</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>aased001</td>
      <td>Aase</td>
      <td>Don</td>
      <td>07/26/1977</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>abada001</td>
      <td>Abad</td>
      <td>Andy</td>
      <td>09/10/2001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">team</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">team</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;franch_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[6]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>team_id</th>
      <th>league</th>
      <th>start</th>
      <th>end</th>
      <th>city</th>
      <th>nickname</th>
      <th>franch_id</th>
      <th>seq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ALT</td>
      <td>UA</td>
      <td>1884</td>
      <td>1884</td>
      <td>Altoona</td>
      <td>Mountain Cities</td>
      <td>ALT</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ARI</td>
      <td>NL</td>
      <td>1998</td>
      <td>0</td>
      <td>Arizona</td>
      <td>Diamondbacks</td>
      <td>ARI</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>BFN</td>
      <td>NL</td>
      <td>1879</td>
      <td>1885</td>
      <td>Buffalo</td>
      <td>Bisons</td>
      <td>BFN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>BFP</td>
      <td>PL</td>
      <td>1890</td>
      <td>1890</td>
      <td>Buffalo</td>
      <td>Bisons</td>
      <td>BFP</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>BL1</td>
      <td>NaN</td>
      <td>1872</td>
      <td>1874</td>
      <td>Baltimore</td>
      <td>Canaries</td>
      <td>BL1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The person_id in the person_code reference data corresponds to the 'XX_id' in the game_logs. They are the IDs associated with the manager, player, coach and umpire names. The teamids are associated with the h_name and v_name in the game log. The team table provides more information about a team, the league and the corresponding franchise Id.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Exploring-the-data">Exploring the data<a class="anchor-link" href="#Exploring-the-data">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the game_log We have data from 1871 - 2016.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">game_log</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[7]:</div>



<div class="output_text output_subarea output_execute_result">
<pre>18900704    24
19150531    24
18840530    24
19140530    24
18900901    24
Name: date, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">game_log</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[8]:</div>



<div class="output_text output_subarea output_execute_result">
<pre>(171907, 161)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">game_log</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[9]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>number_of_game</th>
      <th>day_of_week</th>
      <th>v_name</th>
      <th>v_league</th>
      <th>v_game_number</th>
      <th>h_name</th>
      <th>h_league</th>
      <th>h_game_number</th>
      <th>v_score</th>
      <th>h_score</th>
      <th>length_outs</th>
      <th>day_night</th>
      <th>completion</th>
      <th>forefeit</th>
      <th>protest</th>
      <th>park_id</th>
      <th>attendance</th>
      <th>length_minutes</th>
      <th>v_line_score</th>
      <th>h_line_score</th>
      <th>v_at_bats</th>
      <th>v_hits</th>
      <th>v_doubles</th>
      <th>v_triples</th>
      <th>v_homeruns</th>
      <th>v_rbi</th>
      <th>v_sacrifice_hits</th>
      <th>v_sacrifice_flies</th>
      <th>v_hit_by_pitch</th>
      <th>v_walks</th>
      <th>v_intentional_walks</th>
      <th>v_strikeouts</th>
      <th>v_stolen_bases</th>
      <th>v_caught_stealing</th>
      <th>v_grounded_into_double</th>
      <th>v_first_catcher_interference</th>
      <th>v_left_on_base</th>
      <th>v_pitchers_used</th>
      <th>v_individual_earned_runs</th>
      <th>v_team_earned_runs</th>
      <th>v_wild_pitches</th>
      <th>v_balks</th>
      <th>v_putouts</th>
      <th>v_assists</th>
      <th>v_errors</th>
      <th>v_passed_balls</th>
      <th>v_double_plays</th>
      <th>v_triple_plays</th>
      <th>h_at_bats</th>
      <th>h_hits</th>
      <th>h_doubles</th>
      <th>h_triples</th>
      <th>h_homeruns</th>
      <th>h_rbi</th>
      <th>h_sacrifice_hits</th>
      <th>h_sacrifice_flies</th>
      <th>h_hit_by_pitch</th>
      <th>h_walks</th>
      <th>h_intentional_walks</th>
      <th>h_strikeouts</th>
      <th>h_stolen_bases</th>
      <th>h_caught_stealing</th>
      <th>h_grounded_into_double</th>
      <th>h_first_catcher_interference</th>
      <th>h_left_on_base</th>
      <th>h_pitchers_used</th>
      <th>h_individual_earned_runs</th>
      <th>h_team_earned_runs</th>
      <th>h_wild_pitches</th>
      <th>h_balks</th>
      <th>h_putouts</th>
      <th>h_assists</th>
      <th>h_errors</th>
      <th>h_passed_balls</th>
      <th>h_double_plays</th>
      <th>h_triple_plays</th>
      <th>hp_umpire_id</th>
      <th>hp_umpire_name</th>
      <th>1b_umpire_id</th>
      <th>1b_umpire_name</th>
      <th>2b_umpire_id</th>
      <th>2b_umpire_name</th>
      <th>3b_umpire_id</th>
      <th>3b_umpire_name</th>
      <th>lf_umpire_id</th>
      <th>lf_umpire_name</th>
      <th>rf_umpire_id</th>
      <th>rf_umpire_name</th>
      <th>v_manager_id</th>
      <th>v_manager_name</th>
      <th>h_manager_id</th>
      <th>h_manager_name</th>
      <th>winning_pitcher_id</th>
      <th>winning_pitcher_name</th>
      <th>losing_pitcher_id</th>
      <th>losing_pitcher_name</th>
      <th>saving_pitcher_id</th>
      <th>saving_pitcher_name</th>
      <th>winning_rbi_batter_id</th>
      <th>winning_rbi_batter_id_name</th>
      <th>v_starting_pitcher_id</th>
      <th>v_starting_pitcher_name</th>
      <th>h_starting_pitcher_id</th>
      <th>h_starting_pitcher_name</th>
      <th>v_player_1_id</th>
      <th>v_player_1_name</th>
      <th>v_player_1_def_pos</th>
      <th>v_player_2_id</th>
      <th>v_player_2_name</th>
      <th>v_player_2_def_pos</th>
      <th>v_player_3_id</th>
      <th>v_player_3_name</th>
      <th>v_player_3_def_pos</th>
      <th>v_player_4_id</th>
      <th>v_player_4_name</th>
      <th>v_player_4_def_pos</th>
      <th>v_player_5_id</th>
      <th>v_player_5_name</th>
      <th>v_player_5_def_pos</th>
      <th>v_player_6_id</th>
      <th>v_player_6_name</th>
      <th>v_player_6_def_pos</th>
      <th>v_player_7_id</th>
      <th>v_player_7_name</th>
      <th>v_player_7_def_pos</th>
      <th>v_player_8_id</th>
      <th>v_player_8_name</th>
      <th>v_player_8_def_pos</th>
      <th>v_player_9_id</th>
      <th>v_player_9_name</th>
      <th>v_player_9_def_pos</th>
      <th>h_player_1_id</th>
      <th>h_player_1_name</th>
      <th>h_player_1_def_pos</th>
      <th>h_player_2_id</th>
      <th>h_player_2_name</th>
      <th>h_player_2_def_pos</th>
      <th>h_player_3_id</th>
      <th>h_player_3_name</th>
      <th>h_player_3_def_pos</th>
      <th>h_player_4_id</th>
      <th>h_player_4_name</th>
      <th>h_player_4_def_pos</th>
      <th>h_player_5_id</th>
      <th>h_player_5_name</th>
      <th>h_player_5_def_pos</th>
      <th>h_player_6_id</th>
      <th>h_player_6_name</th>
      <th>h_player_6_def_pos</th>
      <th>h_player_7_id</th>
      <th>h_player_7_name</th>
      <th>h_player_7_def_pos</th>
      <th>h_player_8_id</th>
      <th>h_player_8_name</th>
      <th>h_player_8_def_pos</th>
      <th>h_player_9_id</th>
      <th>h_player_9_name</th>
      <th>h_player_9_def_pos</th>
      <th>additional_info</th>
      <th>acquisition_info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>171902</th>
      <td>20161002</td>
      <td>0</td>
      <td>Sun</td>
      <td>MIL</td>
      <td>NL</td>
      <td>162</td>
      <td>COL</td>
      <td>NL</td>
      <td>162</td>
      <td>6</td>
      <td>4</td>
      <td>60.0</td>
      <td>D</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>DEN02</td>
      <td>27762.0</td>
      <td>203.0</td>
      <td>0200000202</td>
      <td>1100100010</td>
      <td>39.0</td>
      <td>10.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>12.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>30.0</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>41.0</td>
      <td>13.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>12.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>30.0</td>
      <td>13.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>barrs901</td>
      <td>Scott Barry</td>
      <td>woodt901</td>
      <td>Tom Woodring</td>
      <td>randt901</td>
      <td>Tony Randazzo</td>
      <td>ortir901</td>
      <td>Roberto Ortiz</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>counc001</td>
      <td>Craig Counsell</td>
      <td>weisw001</td>
      <td>Walt Weiss</td>
      <td>thort001</td>
      <td>Tyler Thornburg</td>
      <td>rusic001</td>
      <td>Chris Rusin</td>
      <td>knebc001</td>
      <td>Corey Knebel</td>
      <td>susaa001</td>
      <td>Andrew Susac</td>
      <td>cravt001</td>
      <td>Tyler Cravy</td>
      <td>marqg001</td>
      <td>German Marquez</td>
      <td>villj001</td>
      <td>Jonathan Villar</td>
      <td>5.0</td>
      <td>genns001</td>
      <td>Scooter Gennett</td>
      <td>4.0</td>
      <td>cartc002</td>
      <td>Chris Carter</td>
      <td>3.0</td>
      <td>santd002</td>
      <td>Domingo Santana</td>
      <td>9.0</td>
      <td>pereh001</td>
      <td>Hernan Perez</td>
      <td>8.0</td>
      <td>arcio002</td>
      <td>Orlando Arcia</td>
      <td>6.0</td>
      <td>susaa001</td>
      <td>Andrew Susac</td>
      <td>2.0</td>
      <td>elmoj001</td>
      <td>Jake Elmore</td>
      <td>7.0</td>
      <td>cravt001</td>
      <td>Tyler Cravy</td>
      <td>1.0</td>
      <td>blacc001</td>
      <td>Charlie Blackmon</td>
      <td>8.0</td>
      <td>dahld001</td>
      <td>David Dahl</td>
      <td>7.0</td>
      <td>arenn001</td>
      <td>Nolan Arenado</td>
      <td>5.0</td>
      <td>gonzc001</td>
      <td>Carlos Gonzalez</td>
      <td>9.0</td>
      <td>murpt002</td>
      <td>Tom Murphy</td>
      <td>2.0</td>
      <td>pattj005</td>
      <td>Jordan Patterson</td>
      <td>3.0</td>
      <td>valap001</td>
      <td>Pat Valaika</td>
      <td>4.0</td>
      <td>adamc001</td>
      <td>Cristhian Adames</td>
      <td>6.0</td>
      <td>marqg001</td>
      <td>German Marquez</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>171903</th>
      <td>20161002</td>
      <td>0</td>
      <td>Sun</td>
      <td>NYN</td>
      <td>NL</td>
      <td>162</td>
      <td>PHI</td>
      <td>NL</td>
      <td>162</td>
      <td>2</td>
      <td>5</td>
      <td>51.0</td>
      <td>D</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>PHI13</td>
      <td>36935.0</td>
      <td>159.0</td>
      <td>000001100</td>
      <td>00100031x</td>
      <td>33.0</td>
      <td>8.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>24.0</td>
      <td>12.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>33.0</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>27.0</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>barkl901</td>
      <td>Lance Barksdale</td>
      <td>herna901</td>
      <td>Angel Hernandez</td>
      <td>barrt901</td>
      <td>Ted Barrett</td>
      <td>littw901</td>
      <td>Will Little</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>collt801</td>
      <td>Terry Collins</td>
      <td>mackp101</td>
      <td>Pete Mackanin</td>
      <td>murrc002</td>
      <td>Colton Murray</td>
      <td>goede001</td>
      <td>Erik Goeddel</td>
      <td>nerih001</td>
      <td>Hector Neris</td>
      <td>hernc005</td>
      <td>Cesar Hernandez</td>
      <td>ynoag001</td>
      <td>Gabriel Ynoa</td>
      <td>eickj001</td>
      <td>Jerad Eickhoff</td>
      <td>granc001</td>
      <td>Curtis Granderson</td>
      <td>8.0</td>
      <td>cabra002</td>
      <td>Asdrubal Cabrera</td>
      <td>6.0</td>
      <td>brucj001</td>
      <td>Jay Bruce</td>
      <td>9.0</td>
      <td>dudal001</td>
      <td>Lucas Duda</td>
      <td>3.0</td>
      <td>johnk003</td>
      <td>Kelly Johnson</td>
      <td>4.0</td>
      <td>confm001</td>
      <td>Michael Conforto</td>
      <td>7.0</td>
      <td>campe001</td>
      <td>Eric Campbell</td>
      <td>5.0</td>
      <td>plawk001</td>
      <td>Kevin Plawecki</td>
      <td>2.0</td>
      <td>ynoag001</td>
      <td>Gabriel Ynoa</td>
      <td>1.0</td>
      <td>hernc005</td>
      <td>Cesar Hernandez</td>
      <td>4.0</td>
      <td>parej002</td>
      <td>Jimmy Paredes</td>
      <td>7.0</td>
      <td>herro001</td>
      <td>Odubel Herrera</td>
      <td>8.0</td>
      <td>franm004</td>
      <td>Maikel Franco</td>
      <td>5.0</td>
      <td>howar001</td>
      <td>Ryan Howard</td>
      <td>3.0</td>
      <td>ruppc001</td>
      <td>Cameron Rupp</td>
      <td>2.0</td>
      <td>blana001</td>
      <td>Andres Blanco</td>
      <td>6.0</td>
      <td>altha001</td>
      <td>Aaron Altherr</td>
      <td>9.0</td>
      <td>eickj001</td>
      <td>Jerad Eickhoff</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>171904</th>
      <td>20161002</td>
      <td>0</td>
      <td>Sun</td>
      <td>LAN</td>
      <td>NL</td>
      <td>162</td>
      <td>SFN</td>
      <td>NL</td>
      <td>162</td>
      <td>1</td>
      <td>7</td>
      <td>51.0</td>
      <td>D</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>SFO03</td>
      <td>41445.0</td>
      <td>184.0</td>
      <td>000100000</td>
      <td>23000002x</td>
      <td>30.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>24.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>39.0</td>
      <td>16.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>11.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>12.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>27.0</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>knigb901</td>
      <td>Brian Knight</td>
      <td>westj901</td>
      <td>Joe West</td>
      <td>fleta901</td>
      <td>Andy Fletcher</td>
      <td>danlk901</td>
      <td>Kerwin Danley</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>robed001</td>
      <td>Dave Roberts</td>
      <td>bochb002</td>
      <td>Bruce Bochy</td>
      <td>moorm003</td>
      <td>Matt Moore</td>
      <td>maedk001</td>
      <td>Kenta Maeda</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>poseb001</td>
      <td>Buster Posey</td>
      <td>maedk001</td>
      <td>Kenta Maeda</td>
      <td>moorm003</td>
      <td>Matt Moore</td>
      <td>kendh001</td>
      <td>Howie Kendrick</td>
      <td>7.0</td>
      <td>turnj001</td>
      <td>Justin Turner</td>
      <td>5.0</td>
      <td>seagc001</td>
      <td>Corey Seager</td>
      <td>6.0</td>
      <td>puigy001</td>
      <td>Yasiel Puig</td>
      <td>9.0</td>
      <td>gonza003</td>
      <td>Adrian Gonzalez</td>
      <td>3.0</td>
      <td>grany001</td>
      <td>Yasmani Grandal</td>
      <td>2.0</td>
      <td>pedej001</td>
      <td>Joc Pederson</td>
      <td>8.0</td>
      <td>utlec001</td>
      <td>Chase Utley</td>
      <td>4.0</td>
      <td>maedk001</td>
      <td>Kenta Maeda</td>
      <td>1.0</td>
      <td>spand001</td>
      <td>Denard Span</td>
      <td>8.0</td>
      <td>beltb001</td>
      <td>Brandon Belt</td>
      <td>3.0</td>
      <td>poseb001</td>
      <td>Buster Posey</td>
      <td>2.0</td>
      <td>pench001</td>
      <td>Hunter Pence</td>
      <td>9.0</td>
      <td>crawb001</td>
      <td>Brandon Crawford</td>
      <td>6.0</td>
      <td>pagaa001</td>
      <td>Angel Pagan</td>
      <td>7.0</td>
      <td>panij002</td>
      <td>Joe Panik</td>
      <td>4.0</td>
      <td>gillc001</td>
      <td>Conor Gillaspie</td>
      <td>5.0</td>
      <td>moorm003</td>
      <td>Matt Moore</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>171905</th>
      <td>20161002</td>
      <td>0</td>
      <td>Sun</td>
      <td>PIT</td>
      <td>NL</td>
      <td>162</td>
      <td>SLN</td>
      <td>NL</td>
      <td>162</td>
      <td>4</td>
      <td>10</td>
      <td>51.0</td>
      <td>D</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>STL10</td>
      <td>44615.0</td>
      <td>192.0</td>
      <td>000020200</td>
      <td>00100360x</td>
      <td>35.0</td>
      <td>9.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>24.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>36.0</td>
      <td>12.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>27.0</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>cuzzp901</td>
      <td>Phil Cuzzi</td>
      <td>ticht901</td>
      <td>Todd Tichenor</td>
      <td>vanol901</td>
      <td>Larry Vanover</td>
      <td>marqa901</td>
      <td>Alfonso Marquez</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>hurdc001</td>
      <td>Clint Hurdle</td>
      <td>mathm001</td>
      <td>Mike Matheny</td>
      <td>broxj001</td>
      <td>Jonathan Broxton</td>
      <td>nicaj001</td>
      <td>Juan Nicasio</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>piscs001</td>
      <td>Stephen Piscotty</td>
      <td>voger001</td>
      <td>Ryan Vogelsong</td>
      <td>waina001</td>
      <td>Adam Wainwright</td>
      <td>jasoj001</td>
      <td>John Jaso</td>
      <td>3.0</td>
      <td>polag001</td>
      <td>Gregory Polanco</td>
      <td>9.0</td>
      <td>mccua001</td>
      <td>Andrew McCutchen</td>
      <td>8.0</td>
      <td>kangj001</td>
      <td>Jung Ho Kang</td>
      <td>5.0</td>
      <td>joycm001</td>
      <td>Matt Joyce</td>
      <td>7.0</td>
      <td>hansa001</td>
      <td>Alen Hanson</td>
      <td>4.0</td>
      <td>fryee001</td>
      <td>Eric Fryer</td>
      <td>2.0</td>
      <td>florp001</td>
      <td>Pedro Florimon</td>
      <td>6.0</td>
      <td>voger001</td>
      <td>Ryan Vogelsong</td>
      <td>1.0</td>
      <td>carpm002</td>
      <td>Matt Carpenter</td>
      <td>3.0</td>
      <td>diaza003</td>
      <td>Aledmys Diaz</td>
      <td>6.0</td>
      <td>moliy001</td>
      <td>Yadier Molina</td>
      <td>2.0</td>
      <td>piscs001</td>
      <td>Stephen Piscotty</td>
      <td>9.0</td>
      <td>peraj001</td>
      <td>Jhonny Peralta</td>
      <td>5.0</td>
      <td>mossb001</td>
      <td>Brandon Moss</td>
      <td>7.0</td>
      <td>gyorj001</td>
      <td>Jedd Gyorko</td>
      <td>4.0</td>
      <td>gricr001</td>
      <td>Randal Grichuk</td>
      <td>8.0</td>
      <td>waina001</td>
      <td>Adam Wainwright</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>171906</th>
      <td>20161002</td>
      <td>0</td>
      <td>Sun</td>
      <td>MIA</td>
      <td>NL</td>
      <td>161</td>
      <td>WAS</td>
      <td>NL</td>
      <td>162</td>
      <td>7</td>
      <td>10</td>
      <td>51.0</td>
      <td>D</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>WAS11</td>
      <td>28730.0</td>
      <td>216.0</td>
      <td>000230020</td>
      <td>03023002x</td>
      <td>38.0</td>
      <td>14.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>24.0</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>30.0</td>
      <td>10.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>27.0</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>tumpj901</td>
      <td>John Tumpane</td>
      <td>porta901</td>
      <td>Alan Porter</td>
      <td>onorb901</td>
      <td>Brian O'Nora</td>
      <td>kellj901</td>
      <td>Jeff Kellogg</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>mattd001</td>
      <td>Don Mattingly</td>
      <td>baked002</td>
      <td>Dusty Baker</td>
      <td>schem001</td>
      <td>Max Scherzer</td>
      <td>brica001</td>
      <td>Austin Brice</td>
      <td>melam001</td>
      <td>Mark Melancon</td>
      <td>difow001</td>
      <td>Wilmer Difo</td>
      <td>koeht001</td>
      <td>Tom Koehler</td>
      <td>schem001</td>
      <td>Max Scherzer</td>
      <td>gordd002</td>
      <td>Dee Gordon</td>
      <td>4.0</td>
      <td>telit001</td>
      <td>Tomas Telis</td>
      <td>2.0</td>
      <td>pradm001</td>
      <td>Martin Prado</td>
      <td>5.0</td>
      <td>yelic001</td>
      <td>Christian Yelich</td>
      <td>8.0</td>
      <td>bourj002</td>
      <td>Justin Bour</td>
      <td>3.0</td>
      <td>scrux001</td>
      <td>Xavier Scruggs</td>
      <td>7.0</td>
      <td>hoodd001</td>
      <td>Destin Hood</td>
      <td>9.0</td>
      <td>hecha001</td>
      <td>Adeiny Hechavarria</td>
      <td>6.0</td>
      <td>koeht001</td>
      <td>Tom Koehler</td>
      <td>1.0</td>
      <td>turnt001</td>
      <td>Trea Turner</td>
      <td>8.0</td>
      <td>reveb001</td>
      <td>Ben Revere</td>
      <td>7.0</td>
      <td>harpb003</td>
      <td>Bryce Harper</td>
      <td>9.0</td>
      <td>zimmr001</td>
      <td>Ryan Zimmerman</td>
      <td>3.0</td>
      <td>drews001</td>
      <td>Stephen Drew</td>
      <td>5.0</td>
      <td>difow001</td>
      <td>Wilmer Difo</td>
      <td>4.0</td>
      <td>espid001</td>
      <td>Danny Espinosa</td>
      <td>6.0</td>
      <td>lobaj001</td>
      <td>Jose Lobaton</td>
      <td>2.0</td>
      <td>schem001</td>
      <td>Max Scherzer</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>Y</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>game_log seem to have information about</p>
<ul>
<li>general information on the game</li>
<li>the information on the winning team and losing team</li>
<li>player's position and the names along with umpiers for the position</li>
<li>statistics on hosting and visiting team</li>
</ul>
<p>Let us have a look at the team names and the leagues</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">game_log</span><span class="p">[</span><span class="s1">&#39;h_league&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span> <span class="n">plot</span> <span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYcAAAEFCAYAAAAIZiutAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDMuMC4zLCBo
dHRwOi8vbWF0cGxvdGxpYi5vcmcvnQurowAAEYxJREFUeJzt3X+QXWV9x/H3p4ko4g9AorUJNVCi
FlErZpBWp9NCCwG04A8UdISxOJk6aNF2WtHWMkWZsa0WpVWmVFBwrGhRSyoopYjTOlUkiFUBLTuA
kKISDSLVUYx++8d9Um/zbLJ3N9mcXfJ+zezsOd/znJPvhdz97DnnOTepKiRJGvdzQzcgSVp4DAdJ
UsdwkCR1DAdJUsdwkCR1DAdJUsdwkCR1DAdJUsdwkCR1lg7dwFztt99+tXLlyqHbkKRF44Ybbvh2
VS2bZOyiDYeVK1eyfv36oduQpEUjydcnHetlJUlSx3CQJHUMB0lSx3CQJHUMB0lSx3CQJHUMB0lS
x3CQJHUMB0lSZ9E+IT1bK8+8Yt6Ofcdbj5u3Y0vSEDxzkCR1DAdJUsdwkCR1DAdJUsdwkCR1DAdJ
UsdwkCR1DAdJUsdwkCR1DAdJUsdwkCR1DAdJUsdwkCR1DAdJUsdwkCR1DAdJUmeicEjyuiQ3JflK
kg8meViSA5Jcl+TWJB9Kskcb+9C2PtW2rxw7zhta/WtJjh6rr2m1qSRn7uwXKUmanRnDIcly4PeB
1VV1CLAEOAn4C+DcqloF3Auc1nY5Dbi3qg4Czm3jSHJw2+8pwBrg3UmWJFkCvAs4BjgYOLmNlSQN
ZNLLSkuBPZMsBR4OfAM4Arisbb8YOKEtH9/WaduPTJJWv7SqflRVtwNTwGHta6qqbquqB4BL21hJ
0kBmDIeq+m/gbcCdjELhPuAG4LtVtbkN2wAsb8vLgbvavpvb+MeM17faZ1t1SdJAJrmstA+j3+QP
AH4B2IvRJaCt1ZZdtrFttvXpelmbZH2S9Rs3bpypdUnSHE1yWem3gNuramNV/Rj4KPBrwN7tMhPA
CuDutrwB2B+gbX80sGm8vtU+26p3quqCqlpdVauXLVs2QeuSpLmYJBzuBA5P8vB27+BI4GbgWuBF
bcypwOVteV1bp23/VFVVq5/UZjMdAKwCPg9cD6xqs5/2YHTTet2OvzRJ0lwtnWlAVV2X5DLgC8Bm
4EbgAuAK4NIkb2m1C9suFwLvTzLF6IzhpHacm5J8mFGwbAZOr6qfACR5NXAVo5lQF1XVTTvvJUqS
ZmvGcACoqrOAs7Yq38ZoptHWY38InLiN45wDnDNN/Urgykl6kSTNP5+QliR1DAdJUsdwkCR1DAdJ
UsdwkCR1DAdJUsdwkCR1JnrOQcNaeeYV83r8O9563LweX9Li45mDJKljOEiSOoaDJKljOEiSOoaD
JKljOEiSOoaDJKljOEiSOoaDJKljOEiSOoaDJKljOEiSOoaDJKljOEiSOoaDJKljOEiSOoaDJKlj
OEiSOoaDJKljOEiSOoaDJKljOEiSOoaDJKljOEiSOoaDJKljOEiSOoaDJKljOEiSOoaDJKkzUTgk
2TvJZUm+muSWJL+aZN8kVye5tX3fp41NkvOSTCX5UpJDx45zaht/a5JTx+rPTPLlts95SbLzX6ok
aVKTnjm8E/hkVT0ZeDpwC3AmcE1VrQKuaesAxwCr2tda4HyAJPsCZwHPAg4DztoSKG3M2rH91uzY
y5Ik7YgZwyHJo4BfBy4EqKoHquq7wPHAxW3YxcAJbfl44JIa+Rywd5LHA0cDV1fVpqq6F7gaWNO2
PaqqPltVBVwydixJ0gAmOXM4ENgIvDfJjUnek2Qv4HFV9Q2A9v2xbfxy4K6x/Te02vbqG6apS5IG
Mkk4LAUOBc6vqmcA3+dnl5CmM939gppDvT9wsjbJ+iTrN27cuP2uJUlzNkk4bAA2VNV1bf0yRmHx
rXZJiPb9nrHx+4/tvwK4e4b6imnqnaq6oKpWV9XqZcuWTdC6JGkuZgyHqvomcFeSJ7XSkcDNwDpg
y4yjU4HL2/I64JQ2a+lw4L522ekq4Kgk+7Qb0UcBV7Vt9yc5vM1SOmXsWJKkASydcNxrgA8k2QO4
DXgFo2D5cJLTgDuBE9vYK4FjgSngB20sVbUpyZuB69u4s6tqU1t+FfA+YE/gE+1LkjSQicKhqr4I
rJ5m05HTjC3g9G0c5yLgomnq64FDJulFkjT/fEJaktQxHCRJHcNBktQxHCRJHcNBktQxHCRJHcNB
ktQxHCRJHcNBktQxHCRJHcNBktQxHCRJHcNBktQxHCRJHcNBktQxHCRJHcNBktQxHCRJHcNBktQx
HCRJHcNBktQxHCRJHcNBktQxHCRJHcNBktQxHCRJHcNBktQxHCRJHcNBktQxHCRJHcNBktQxHCRJ
HcNBktQxHCRJHcNBktQxHCRJHcNBktQxHCRJnYnDIcmSJDcm+XhbPyDJdUluTfKhJHu0+kPb+lTb
vnLsGG9o9a8lOXqsvqbVppKcufNeniRpLmZz5nAGcMvY+l8A51bVKuBe4LRWPw24t6oOAs5t40hy
MHAS8BRgDfDuFjhLgHcBxwAHAye3sZKkgUwUDklWAMcB72nrAY4ALmtDLgZOaMvHt3Xa9iPb+OOB
S6vqR1V1OzAFHNa+pqrqtqp6ALi0jZUkDWTSM4d3AH8M/LStPwb4blVtbusbgOVteTlwF0Dbfl8b
/3/1rfbZVl2SNJAZwyHJc4F7quqG8fI0Q2uGbbOtT9fL2iTrk6zfuHHjdrqWJO2ISc4cng38TpI7
GF3yOYLRmcTeSZa2MSuAu9vyBmB/gLb90cCm8fpW+2yr3qmqC6pqdVWtXrZs2QStS5LmYsZwqKo3
VNWKqlrJ6Ibyp6rqZcC1wIvasFOBy9vyurZO2/6pqqpWP6nNZjoAWAV8HrgeWNVmP+3R/ox1O+XV
SZLmZOnMQ7bp9cClSd4C3Ahc2OoXAu9PMsXojOEkgKq6KcmHgZuBzcDpVfUTgCSvBq4ClgAXVdVN
O9CXJGkHzSocqurTwKfb8m2MZhptPeaHwInb2P8c4Jxp6lcCV86mF0nS/PEJaUlSx3CQJHUMB0lS
x3CQJHUMB0lSx3CQJHUMB0lSx3CQJHUMB0lSx3CQJHUMB0lSx3CQJHUMB0lSx3CQJHUMB0lSx3CQ
JHUMB0lSx3CQJHUMB0lSx3CQJHUMB0lSx3CQJHUMB0lSx3CQJHUMB0lSx3CQJHUMB0lSx3CQJHUM
B0lSx3CQJHUMB0lSx3CQJHUMB0lSx3CQJHUMB0lSx3CQJHUMB0lSx3CQJHVmDIck+ye5NsktSW5K
ckar75vk6iS3tu/7tHqSnJdkKsmXkhw6dqxT2/hbk5w6Vn9mki+3fc5Lkvl4sZKkyUxy5rAZ+MOq
+mXgcOD0JAcDZwLXVNUq4Jq2DnAMsKp9rQXOh1GYAGcBzwIOA87aEihtzNqx/dbs+EuTJM3VjOFQ
Vd+oqi+05fuBW4DlwPHAxW3YxcAJbfl44JIa+Rywd5LHA0cDV1fVpqq6F7gaWNO2PaqqPltVBVwy
dixJ0gBmdc8hyUrgGcB1wOOq6hswChDgsW3YcuCusd02tNr26humqU/3569Nsj7J+o0bN86mdUnS
LEwcDkkeAXwEeG1VfW97Q6ep1RzqfbHqgqpaXVWrly1bNlPLkqQ5migckjyEUTB8oKo+2srfapeE
aN/vafUNwP5ju68A7p6hvmKauiRpIJPMVgpwIXBLVf312KZ1wJYZR6cCl4/VT2mzlg4H7muXna4C
jkqyT7sRfRRwVdt2f5LD2591ytixJEkDWDrBmGcDLwe+nOSLrfZG4K3Ah5OcBtwJnNi2XQkcC0wB
PwBeAVBVm5K8Gbi+jTu7qja15VcB7wP2BD7RviRJA5kxHKrqM0x/XwDgyGnGF3D6No51EXDRNPX1
wCEz9SJJ2jV8QlqS1DEcJEkdw0GS1DEcJEkdw0GS1DEcJEkdw0GS1DEcJEkdw0GS1DEcJEkdw0GS
1DEcJEkdw0GS1DEcJEkdw0GS1DEcJEkdw0GS1DEcJEkdw0GS1DEcJEkdw0GS1DEcJEkdw0GS1DEc
JEkdw0GS1DEcJEkdw0GS1DEcJEkdw0GS1Fk6dAN68Ft55hXzevw73nrcvB5f2h155iBJ6hgOkqSO
4SBJ6hgOkqSO4SBJ6hgOkqSO4SBJ6iyYcEiyJsnXkkwlOXPofiRpd7YgHoJLsgR4F/DbwAbg+iTr
qurmYTuTFv9DfIu9fw1joZw5HAZMVdVtVfUAcClw/MA9SdJua0GcOQDLgbvG1jcAzxqoF0kLyGI/
85nP/uez91TVvB184iaSE4Gjq+qVbf3lwGFV9Zqtxq0F1rbVJwFfm6eW9gO+PU/H3hXsf1j2P6zF
3P989/6Eqlo2ycCFcuawAdh/bH0FcPfWg6rqAuCC+W4myfqqWj3ff858sf9h2f+wFnP/C6n3hXLP
4XpgVZIDkuwBnASsG7gnSdptLYgzh6ranOTVwFXAEuCiqrpp4LYkabe1IMIBoKquBK4cuo9m3i9d
zTP7H5b9D2sx979gel8QN6QlSQvLQrnnIElaQAwHSVLHcJDmSRIf5NScJHnI0D0YDtuR5M6he5ir
JC8cuoe5SrJ/kj8auo+d4B+HbmB3luS1Q/cwGxk5Isl7GD37NSjDYfsydAM74NyhG5iNJPsleVWS
fwM+DTxu4JZ2hkXz9yfJC5LcmuS+JN9Lcn+S7w3d1w76g6EbmESSZyV5J/B1Rs93/Tvw5GG7WkBT
WReoxTyVa8H/YErySOD5wEuBJwIfAw6sqhWDNrbzLKa/P38JPK+qbhm6kZ1oQb8HkpwDvBi4E/gg
cDawvqouHrSxZrcPhyTb+u0iwCN2ZS872WL4wXQP8HngT4HPVFUlef7APc1Kkn9m+v/WAR6zi9vZ
Ed96kAUDLPz3wFpGnw93PvDxqvphkgXT824fDsAjt7PtnbusizlI8mW2/YNpMVyWeSOjj0o5H/iH
JB8auJ+5eNscty0069t//38CfrSlWFUfHa6lmSW5n9F7YMtZwpb3Q4A9B2lqcj8PHAWcDLwjybXA
nkmWVtXmYVvzIbhFLckTpisz+uDCN1bVsbu4pTlJciCjN8hJwCrgLOBjVfVfgzY2gSS/WFWLduLC
FkneO025qup3d3kzu6EkDwOey+h98Bzgmqp66aA97e7hkOTPtrO5qurNu6yZHZDkVxhdu38xcDvw
kar622G7mr0kTwPeweijhX9p6H5mkuQLVXVoW/5IVS3aWWKLUfuh+nvAQcCXGH0u2+C/dU9imkva
xejjuv8TeMbQ9x68rATfn6a2F3Aao2vGCzYckjyR0W/bJwPfAT7EKPB/c9DG5qCF28nAS4A7GAXE
YjB+0/PAwbrYQe2H7GnAU4CHbakvgjOHi4EfM5rhcyyj/s8YtKPJTXdJeyXwJ8Cf79pWert9OFTV
27cst9kzZwCvYPRPlb59W/stEF9l9KZ4XlVNASR53bAtTW474fYbQ/Y1S7WN5cXm/Yz+Ph3NaNbM
y4DFcIP64Kp6KkCSCxlNcFgUqmraAEiyL/CvjGYwDcbnHBj9z0jyFkanpUuBQ6vq9VV1z8CtzeSF
wDeBa5P8fZIjWeDT97byVeBIRuH2nKr6G+AnA/c0W0/f8lwA8LS2vBifEzioqt4EfL9dzjgOeOrA
PU3ix1sWFsvlpJlU1SYWwPt4tz9zSPJXwAsYfVTuU6vqfwZuaWJV9THgY0n2Ak4AXgc8Lsn5jG7o
/sugDc7shYzOHK5N8klGZ2uDvylmo6qWDN3DTrLlh+x3kxzC6JeOlcO1M7Gnj4VwGM32+V5brqp6
1HCtzU2SI4B7B+/DG9L5KaOpe5v5/5cFFuVfrnZKeiLwkqo6Yuh+JjEWbicDRzC6jrwYwu1BI8kr
gY8wOlt4H6NnfN5UVX83ZF8PZtuYir4vo38i+ZSq+uqu7+pndvtw0MKyGMPtwSDJQxmdya0Etnzo
W1XV2YM19SA3zVT0Ar5TVdNNktnlDAdJtMt69wE3MHbfZ3zChnYvhoMkknylqg4Zug8tHM5WkgTw
H0kWw+wk7SKeOUgiyc2MnjK+ndEEjS0TMp42aGMajOEgaVuf00VVfX1X96KFwXCQJHW85yBJ6hgO
kqSO4SBJ6hgOkqSO4SBJ6vwvF7LF2wXbnJUAAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">league_info</span><span class="p">(</span><span class="n">league</span><span class="p">):</span>
    <span class="n">league_games</span> <span class="o">=</span> <span class="n">game_log</span><span class="p">[</span><span class="n">game_log</span><span class="p">[</span><span class="s1">&#39;h_league&#39;</span><span class="p">]</span> <span class="o">==</span><span class="n">league</span><span class="p">]</span>
    <span class="n">earliest</span> <span class="o">=</span> <span class="n">league_games</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">latest</span> <span class="o">=</span> <span class="n">league_games</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> played games from </span><span class="si">{}</span><span class="s2"> to </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">league</span><span class="p">,</span><span class="n">earliest</span><span class="p">,</span> <span class="n">latest</span><span class="p">))</span>
    
    
<span class="k">for</span> <span class="n">league</span> <span class="ow">in</span> <span class="n">game_log</span><span class="p">[</span><span class="s1">&#39;h_league&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">league_info</span><span class="p">(</span><span class="n">league</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre>nan played games from nan to nan
NL played games from 18760422 to 20161002
AA played games from 18820502 to 18911006
UA played games from 18840417 to 18841019
PL played games from 18900419 to 18901004
AL played games from 19010424 to 20161002
FL played games from 19140413 to 19151003
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Of the following leagues -</p>
<ul>
<li>NL: National League</li>
<li>AL: American League</li>
<li>AA: American Association</li>
<li>FL: Federal League</li>
<li>PL: Players League</li>
<li>UA: Union Association</li>
</ul>
<p>Nation league and American leagues have more games for them as they have been operating for a long time 
Let us also go ahead and look at frach_id and how it ties back to the teams.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">league_team</span> <span class="o">=</span> <span class="n">game_log</span><span class="p">[[</span><span class="s1">&#39;h_league&#39;</span><span class="p">,</span><span class="s1">&#39;h_name&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">pivot_table</span> <span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;h_league&#39;</span><span class="p">,</span><span class="s1">&#39;h_name&#39;</span><span class="p">],</span> <span class="n">aggfunc</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">)</span>
<span class="n">league_team</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[12]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th>h_league</th>
      <th>h_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">AA</th>
      <th>BL2</th>
    </tr>
    <tr>
      <th>BR3</th>
    </tr>
    <tr>
      <th>BR4</th>
    </tr>
    <tr>
      <th>BS2</th>
    </tr>
    <tr>
      <th>CL3</th>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># also want to explaore the franch_id </span>
<span class="n">team</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[13]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>team_id</th>
      <th>league</th>
      <th>start</th>
      <th>end</th>
      <th>city</th>
      <th>nickname</th>
      <th>franch_id</th>
      <th>seq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ALT</td>
      <td>UA</td>
      <td>1884</td>
      <td>1884</td>
      <td>Altoona</td>
      <td>Mountain Cities</td>
      <td>ALT</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ARI</td>
      <td>NL</td>
      <td>1998</td>
      <td>0</td>
      <td>Arizona</td>
      <td>Diamondbacks</td>
      <td>ARI</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>BFN</td>
      <td>NL</td>
      <td>1879</td>
      <td>1885</td>
      <td>Buffalo</td>
      <td>Bisons</td>
      <td>BFN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>BFP</td>
      <td>PL</td>
      <td>1890</td>
      <td>1890</td>
      <td>Buffalo</td>
      <td>Bisons</td>
      <td>BFP</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>BL1</td>
      <td>NaN</td>
      <td>1872</td>
      <td>1874</td>
      <td>Baltimore</td>
      <td>Canaries</td>
      <td>BL1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">team</span><span class="p">[</span><span class="s1">&#39;franch_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">team</span><span class="p">[</span><span class="n">team</span><span class="p">[</span><span class="s1">&#39;franch_id&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;BS1&#39;</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[14]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>team_id</th>
      <th>league</th>
      <th>start</th>
      <th>end</th>
      <th>city</th>
      <th>nickname</th>
      <th>franch_id</th>
      <th>seq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>21</th>
      <td>BS1</td>
      <td>NaN</td>
      <td>1871</td>
      <td>1875</td>
      <td>Boston</td>
      <td>Braves</td>
      <td>BS1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>22</th>
      <td>BSN</td>
      <td>NL</td>
      <td>1876</td>
      <td>1952</td>
      <td>Boston</td>
      <td>Braves</td>
      <td>BS1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>23</th>
      <td>MLN</td>
      <td>NL</td>
      <td>1953</td>
      <td>1965</td>
      <td>Milwaukee</td>
      <td>Braves</td>
      <td>BS1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>24</th>
      <td>ATL</td>
      <td>NL</td>
      <td>1966</td>
      <td>0</td>
      <td>Atlanta</td>
      <td>Braves</td>
      <td>BS1</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are cases when the team assumes a different name, in different city and league, but is represented by the same franchise id</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are multiple defensive position numbers in the data set. Let us find out what do they mean - 
According to <a href="https://en.wikipedia.org/wiki/Baseball_positions">https://en.wikipedia.org/wiki/Baseball_positions</a> we have the following positions -</p>
<ul>
<li>Pitcher</li>
<li>Catcher</li>
<li>First baseman</li>
<li>Second baseman</li>
<li>Third baseman</li>
<li>Shortstop</li>
<li>Left fielder</li>
<li>Center fielder</li>
<li>Right fielders</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To insert the data in the database, we need a primary key for each column. Retrosheet talks about the unique IDs in here - 
<a href="https://www.retrosheet.org/eventfile.htm">https://www.retrosheet.org/eventfile.htm</a></p>
<p>They define ID as - 
Each game begins with a twelve character ID record which identifies the date, home team, and number of the game. For example, ATL198304080 should be read as follows. The first three characters identify the home team (the Braves). The next four are the year (1983). The next two are the month (April) using the standard numeric notation, 04, followed by the day (08). The last digit indicates if this is a single game (0), first game (1) or second game (2) if more than one game is played during a day, usually a double header The id record starts the description of a game thus ending the description of the preceding game in the file.</p>
<p>We will try to create this Id while storing the table in DB.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Import-data-into-the-database">Import data into the database<a class="anchor-link" href="#Import-data-into-the-database">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will go ahead and create the database in the in Sqlite. There are three ways to do this</p>
<ul>
<li>Using python SQLlite library - This gives us the highest level of control over reading and writing the data. But is highly manual</li>
<li>Using pandas - This is a handy method, but pandas sometimes converts the datatype while reading in automatically. Also the data needs to be small enough to be accommodated in the memory </li>
<li>Using SQLite shell - This is an easy method. But we run into some problems ascertaining datatypes based on the first row of the data, need to remove the header while reading the data and so on. However, we may not always have access to the shell.</li>
</ul>
<p>For this excercise, we will be using pandas method.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create functions needed to see this through.</span>

<span class="n">database</span> <span class="o">=</span> <span class="s2">&quot;mlb.db&quot;</span>

<span class="c1"># function to run a query</span>
<span class="k">def</span> <span class="nf">run_query</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">database</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
    
<span class="c1"># function to return not table objects such as views</span>
<span class="k">def</span> <span class="nf">run_command</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">database</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
        <span class="n">conn</span><span class="o">.</span><span class="n">isolation_level</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
        
<span class="c1"># function show the list of all table and view</span>

<span class="k">def</span> <span class="nf">show_tables</span><span class="p">():</span>
    <span class="n">q</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">        SELECT </span>
<span class="s1">            name</span>
<span class="s1">            , type</span>
<span class="s1">        FROM sqlite_master</span>
<span class="s1">        WHERE type IN (&#39;table&#39;, &#39;view&#39;)</span>
<span class="s1">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">run_query</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
        
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ideally we would like to create a source schema to store our tables, but as the only schemas allowed in sqllite are main and temp we ill go ahead and use SRC_tablename convention for the source tables.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#create a dictionary mapping the required SQL table name to the pandas tablename</span>
<span class="n">table_data</span><span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;SRC_game_log&#39;</span> <span class="p">:</span> <span class="n">game_log</span>
    <span class="p">,</span> <span class="s1">&#39;SRC_park_codes&#39;</span><span class="p">:</span><span class="n">park_codes</span>
    <span class="p">,</span> <span class="s1">&#39;SRC_person_codes&#39;</span><span class="p">:</span> <span class="n">person_code</span>
    <span class="p">,</span> <span class="s1">&#39;SRC_team&#39;</span> <span class="p">:</span> <span class="n">team</span>
<span class="p">}</span>

<span class="k">with</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">database</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">table_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;DROP TABLE IF EXISTS </span><span class="si">{}</span><span class="s2">;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">table_name</span><span class="p">))</span>
        <span class="n">data</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">table_name</span><span class="p">,</span><span class="n">conn</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
        
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_tables</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[17]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Person</td>
      <td>table</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ODS_Person</td>
      <td>table</td>
    </tr>
    <tr>
      <th>2</th>
      <td>park</td>
      <td>table</td>
    </tr>
    <tr>
      <th>3</th>
      <td>league</td>
      <td>table</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SRC_game_log</td>
      <td>table</td>
    </tr>
    <tr>
      <th>5</th>
      <td>SRC_park_codes</td>
      <td>table</td>
    </tr>
    <tr>
      <th>6</th>
      <td>SRC_person_codes</td>
      <td>table</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SRC_team</td>
      <td>table</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#adding unique id to the game log table</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Based on the above description of the primary id, we should look at h_name, date, h_game_number field. Let us see if there are any duplicates with this combination.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">q1</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    SELECT </span>
<span class="s1">    </span>
<span class="s1">          h_name||date||h_game_number</span>
<span class="s1">          , count(*)</span>
<span class="s1">    FROM SRC_game_log</span>
<span class="s1">    group by h_name||date||h_game_number</span>
<span class="s1">    Having count(*) &gt; 1</span>

<span class="s1">&#39;&#39;&#39;</span>

<span class="n">run_query</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[19]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>h_name||date||h_game_number</th>
      <th>count(*)</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are no duplicates in this column and therefore this ID can be used safely as a primaruy key.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># update the table with extra column game_id as unique key</span>

<span class="n">q2</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    ALTER TABLE SRC_game_log</span>
<span class="s1">    ADD COLUMN game_id NVARCHAR(500);</span>
<span class="s1">    </span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">run_query</span><span class="p">(</span><span class="n">q2</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># let us update the value of game_id with the unique id value</span>

<span class="n">q3</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    UPDATE SRC_game_log</span>
<span class="s1">    SET game_id =  h_name||date||h_game_number</span>
<span class="s1">    WHERE game_id is NULL;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">run_command</span><span class="p">(</span><span class="n">q3</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">q4</span> <span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    SELECT game_id</span>
<span class="s1">            , h_name</span>
<span class="s1">            , date</span>
<span class="s1">            , h_game_number</span>
<span class="s1">    FROM SRC_game_log</span>
<span class="s1">    limit 5;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">run_query</span><span class="p">(</span><span class="n">q4</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[22]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>game_id</th>
      <th>h_name</th>
      <th>date</th>
      <th>h_game_number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>FW1187105041</td>
      <td>FW1</td>
      <td>18710504</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>WS3187105051</td>
      <td>WS3</td>
      <td>18710505</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>RC1187105061</td>
      <td>RC1</td>
      <td>18710506</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CH1187105081</td>
      <td>CH1</td>
      <td>18710508</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>TRO187105091</td>
      <td>TRO</td>
      <td>18710509</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Normalise-the-data">Normalise the data<a class="anchor-link" href="#Normalise-the-data">&#182;</a></h1><ul>
<li><p>We see in the game_log that the all the id fields are followed by the name. This information is present in the person_code table. Therefore, we will go ahead and remove the name fields. We should also note that the game_log is all about the game. But the player name provides us information about the player.</p>
</li>
<li><p>In the game_log we see the name of the team paired with the league name. But we get the same information from the team table. We can drop the league name field for both the visiting and the hosting team from the game log</p>
</li>
<li><p>In the park_codes table, we see the start date and the end date signifying the dates when the game was played at the park. This information can be obtained from the 'date' column of the game_log table and hence we will drop this</p>
</li>
<li><p>in game_log, we have a listing for 9 players on each team with their positions - we can remove these and have one table that tracks player appearances and their positions.</p>
</li>
</ul>
<p>We will use the following DB table to create our database. We will first create the tables that do not have any foregin key - person , person_apprearance, apprearance_type, and park.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">html</span>

&lt;img src=&quot;img/schema-screenshot.png&quot; , width = 30 , height = 40&gt;
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>


<div class="output_html rendered_html output_subarea ">

<img src="img/schema-screenshot.png" , width = 30 , height = 40>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Create-the-Database">Create the Database<a class="anchor-link" href="#Create-the-Database">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create the table person. Since these are the reference table, we will prefix them with ODS</span>

<span class="n">q5</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    CREATE TABLE IF NOT EXISTS Person(</span>
<span class="s1">        person_id NVARCHAR(50) PRIMARY KEY</span>
<span class="s1">        ,first_name TEXT</span>
<span class="s1">        ,last_name TEXT</span>
<span class="s1">);</span>
<span class="s1">    </span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">run_command</span><span class="p">(</span><span class="n">q5</span><span class="p">)</span>

<span class="c1"># Insert values into the table </span>
<span class="n">q6</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    INSERT OR IGNORE INTO person</span>
<span class="s1">    SELECT </span>
<span class="s1">        id</span>
<span class="s1">        ,last</span>
<span class="s1">        , first </span>
<span class="s1">    FROM SRC_person_codes;</span>

<span class="s1">&#39;&#39;&#39;</span>
<span class="n">run_command</span><span class="p">(</span><span class="n">q6</span><span class="p">)</span>
<span class="c1"># View the first 10 lines of the table </span>

<span class="n">q7</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    SELECT * </span>
<span class="s1">    FROM person</span>
<span class="s1">    LIMIT 10;</span>
<span class="s1">    </span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">run_query</span><span class="p">(</span><span class="n">q7</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[23]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>person_id</th>
      <th>first_name</th>
      <th>last_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>aardd001</td>
      <td>Aardsma</td>
      <td>David</td>
    </tr>
    <tr>
      <th>1</th>
      <td>aaroh101</td>
      <td>Aaron</td>
      <td>Hank</td>
    </tr>
    <tr>
      <th>2</th>
      <td>aarot101</td>
      <td>Aaron</td>
      <td>Tommie</td>
    </tr>
    <tr>
      <th>3</th>
      <td>aased001</td>
      <td>Aase</td>
      <td>Don</td>
    </tr>
    <tr>
      <th>4</th>
      <td>abada001</td>
      <td>Abad</td>
      <td>Andy</td>
    </tr>
    <tr>
      <th>5</th>
      <td>abadf001</td>
      <td>Abad</td>
      <td>Fernando</td>
    </tr>
    <tr>
      <th>6</th>
      <td>abadj101</td>
      <td>Abadie</td>
      <td>John</td>
    </tr>
    <tr>
      <th>7</th>
      <td>abbae101</td>
      <td>Abbaticchio</td>
      <td>Ed</td>
    </tr>
    <tr>
      <th>8</th>
      <td>abbeb101</td>
      <td>Abbey</td>
      <td>Bert</td>
    </tr>
    <tr>
      <th>9</th>
      <td>abbec101</td>
      <td>Abbey</td>
      <td>Charlie</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Let us create the park table </span>
<span class="n">q8</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    CREATE TABLE IF NOT EXISTS park(</span>
<span class="s1">        park_id NVARCHAR(50) PRIMARY KEY</span>
<span class="s1">        , name TEXT</span>
<span class="s1">        , nickname TEXT</span>
<span class="s1">        , city TEXT</span>
<span class="s1">        , state TEXT</span>
<span class="s1">        , notes TEXT</span>
<span class="s1">    </span>
<span class="s1">    );</span>


<span class="s1">&#39;&#39;&#39;</span>

<span class="n">run_command</span><span class="p">(</span><span class="n">q8</span><span class="p">)</span>


<span class="c1"># insert the values from the SRC_park table</span>

<span class="n">q9</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    INSERT OR IGNORE INTO park</span>
<span class="s1">    SELECT </span>
<span class="s1">        park_id</span>
<span class="s1">        , name</span>
<span class="s1">        , aka</span>
<span class="s1">        , city</span>
<span class="s1">        , state</span>
<span class="s1">        , notes</span>
<span class="s1">    FROM SRC_park_codes;</span>
<span class="s1">    </span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">run_command</span><span class="p">(</span><span class="n">q9</span><span class="p">)</span>

<span class="c1"># Select top 10 values from the park table</span>

<span class="n">q10</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    SELECT *</span>
<span class="s1">    FROM park</span>
<span class="s1">    LIMIT 10;</span>
<span class="s1">    </span>
<span class="s1">    &#39;&#39;&#39;</span>

<span class="n">run_query</span><span class="p">(</span><span class="n">q10</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[24]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>park_id</th>
      <th>name</th>
      <th>nickname</th>
      <th>city</th>
      <th>state</th>
      <th>notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ALB01</td>
      <td>Riverside Park</td>
      <td>None</td>
      <td>Albany</td>
      <td>NY</td>
      <td>TRN:9/11/80;6/15&amp;9/10/1881;5/16-5/18&amp;5/30/1882</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ALT01</td>
      <td>Columbia Park</td>
      <td>None</td>
      <td>Altoona</td>
      <td>PA</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ANA01</td>
      <td>Angel Stadium of Anaheim</td>
      <td>Edison Field; Anaheim Stadium</td>
      <td>Anaheim</td>
      <td>CA</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ARL01</td>
      <td>Arlington Stadium</td>
      <td>None</td>
      <td>Arlington</td>
      <td>TX</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ARL02</td>
      <td>Rangers Ballpark in Arlington</td>
      <td>The Ballpark in Arlington; Ameriquest Fl</td>
      <td>Arlington</td>
      <td>TX</td>
      <td>None</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ATL01</td>
      <td>Atlanta-Fulton County Stadium</td>
      <td>None</td>
      <td>Atlanta</td>
      <td>GA</td>
      <td>None</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ATL02</td>
      <td>Turner Field</td>
      <td>None</td>
      <td>Atlanta</td>
      <td>GA</td>
      <td>None</td>
    </tr>
    <tr>
      <th>7</th>
      <td>ATL03</td>
      <td>Suntrust Park</td>
      <td>None</td>
      <td>Atlanta</td>
      <td>GA</td>
      <td>None</td>
    </tr>
    <tr>
      <th>8</th>
      <td>BAL01</td>
      <td>Madison Avenue Grounds</td>
      <td>None</td>
      <td>Baltimore</td>
      <td>MD</td>
      <td>WS3</td>
    </tr>
    <tr>
      <th>9</th>
      <td>BAL02</td>
      <td>Newington Park</td>
      <td>None</td>
      <td>Baltimore</td>
      <td>MD</td>
      <td>BL1:1872-74; BL4:1873; BL2: 1882</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create the league table</span>

<span class="n">q11</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    CREATE TABLE IF NOT EXISTS league(</span>
<span class="s1">        league_id NVARCHAR(50)</span>
<span class="s1">        , league_name TEXT</span>
<span class="s1">        )</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">;</span>

<span class="n">run_command</span><span class="p">(</span><span class="n">q11</span><span class="p">)</span>


<span class="c1"># inserting the data into the table</span>

<span class="n">leagues</span> <span class="o">=</span> <span class="p">{</span>
<span class="s1">&#39;NL&#39;</span><span class="p">:</span> <span class="s1">&#39;National League&#39;</span>
<span class="p">,</span><span class="s1">&#39;AL&#39;</span><span class="p">:</span> <span class="s1">&#39;American League&#39;</span>
<span class="p">,</span><span class="s1">&#39;AA&#39;</span><span class="p">:</span> <span class="s1">&#39;American Association&#39;</span>
<span class="p">,</span><span class="s1">&#39;FL&#39;</span><span class="p">:</span> <span class="s1">&#39;Federal League&#39;</span>
<span class="p">,</span><span class="s1">&#39;PL&#39;</span><span class="p">:</span> <span class="s1">&#39;Players League&#39;</span>
<span class="p">,</span><span class="s1">&#39;UA&#39;</span><span class="p">:</span> <span class="s1">&#39;Union Association&#39;</span><span class="p">}</span>


<span class="k">with</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">database</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">identity</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="n">leagues</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">q</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39; INSERT OR IGNORE INTO league VALUES(&quot;</span><span class="si">{}</span><span class="s1">&quot;, &quot;</span><span class="si">{}</span><span class="s1">&quot;)&#39;&#39;&#39;</span><span class="o">.</span><span class="n">format</span> <span class="p">(</span><span class="n">identity</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
        <span class="n">conn</span><span class="o">.</span><span class="n">isolation_level</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># select some values from the data </span>

<span class="n">q12</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    SELECT *</span>
<span class="s1">    FROM league</span>
<span class="s1">    LIMIT 10;</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">run_query</span><span class="p">(</span><span class="n">q12</span><span class="p">)</span>    
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[26]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>league_id</th>
      <th>league_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NL</td>
      <td>National League</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AL</td>
      <td>American League</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AA</td>
      <td>American Association</td>
    </tr>
    <tr>
      <th>3</th>
      <td>FL</td>
      <td>Federal League</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PL</td>
      <td>Players League</td>
    </tr>
    <tr>
      <th>5</th>
      <td>UA</td>
      <td>Union Association</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NL</td>
      <td>National League</td>
    </tr>
    <tr>
      <th>7</th>
      <td>AL</td>
      <td>American League</td>
    </tr>
    <tr>
      <th>8</th>
      <td>AA</td>
      <td>American Association</td>
    </tr>
    <tr>
      <th>9</th>
      <td>FL</td>
      <td>Federal League</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Create the appearence type table </span>
<span class="n">q13</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    CREATE TABLE IF NOT EXISTS appearence_type(</span>
<span class="s1">        appearance_type_id</span>
<span class="s1">    </span>
<span class="s1">    </span>
<span class="s1">    )</span>

<span class="s1">&#39;&#39;&#39;</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can go ahead and create rest of the table laid out in the database diagram.</p>
<p>The information used here was obtained free of
     charge from and is copyrighted by Retrosheet.  Interested
     parties may contact Retrosheet at "www.retrosheet.org".</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

</div>
</div>
</div>

</div>
 


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
                </article>
            </aside><!-- /#featured -->
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">

            <li><article class="hentry">
                <header>
                    <h1><a href="/chinook-music-store.html" rel="bookmark"
                           title="Permalink to If I am a music store manager">If I am a music store manager</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2019-05-25T20:00:00-04:00">
                Published: Sat 25 May 2019
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/suhasini-radhakrishnan.html">Suhasini Radhakrishnan</a>
        </address>
<p>In <a href="/category/posts.html">Posts</a>.</p>
<p>tags: <a href="/tag/python-sqlite3.html">python Sqlite3</a> </p>
</footer><!-- /.post-info -->                <p>Analyzing music store data with pandas and Sqlite</p>
                <a class="readmore" href="/chinook-music-store.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/first-post.html" rel="bookmark"
                           title="Permalink to First Post">First Post</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-06-08T20:00:00-04:00">
                Published: Wed 08 June 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/me.html">me</a>
        </address>
<p>In <a href="/category/posts.html">Posts</a>.</p>
<p>tags: <a href="/tag/python.html">python</a> </p>
</footer><!-- /.post-info -->                <p>My first post, read it to find out.</p>
                <a class="readmore" href="/first-post.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>
                </ol><!-- /#posts-list -->
                </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>